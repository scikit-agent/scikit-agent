
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/models/plot_resource_extraction.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_models_plot_resource_extraction.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_models_plot_resource_extraction.py:


############################
Resource Extraction Model
############################

The resource extraction problem models the optimal management of a renewable
or depletable resource (fishery, forest, mineral deposit, etc.).
The decision-maker must balance immediate profits from extraction against
preserving the resource stock for future use. Under certain formulations with
stochastic growth, this problem admits analytical or semi-analytical solutions

The model involves a growing resource with stochastic shocks, a controllable
extraction rate, and reward function that combines revenue and extraction costs.
The planner agent must balance present profit with future resource availability.

Model Structure
==================

- **State Variable:** :math:`x`: Resource stock level
- **Control Variable:** :math:`u`: Extraction rate (constrained between 0 and current stock $x$)

**Dynamics**

The resource stock evolves as:

 .. math::

    x_{t+1} = r(x_t - u_t) + \epsilon_t

where :math:`r > 1` is the growth rate and :math:`\epsilon_t` is a random shock.

**Reward:**

Single-period profit combines revenue and extraction costs:

 .. math::

    \mathrm{profit} = p \cdot u - \frac{c}{2} u^2

The linear revenue term :math:`p \cdot u` represents market value, while the quadratic cost :math:`\frac{c}{2}u^2` reflects increasing marginal extraction costs (it becomes harder and more expensive to extract at higher rates).

**Parameters:**

- :math:`r`: Growth rate (e.g., 1.1 = 10% growth per period)
- :math:`p`: Price per unit extracted
- :math:`c`: Cost parameter (controls extraction cost curvature)
- :math:`\gamma` (`DiscFac`): Discount factor for future rewards
- :math:`\sigma`: Standard deviation of random growth shocks

.. GENERATED FROM PYTHON SOURCE LINES 51-57

.. code-block:: Python


    import matplotlib.pyplot as plt
    import skagent as ska
    from skagent.distributions import Normal
    import skagent.models.resource_extraction as rex








.. GENERATED FROM PYTHON SOURCE LINES 58-62

Model Inspection
-------------------

First, let's load the predefined model elements and inspect them.

.. GENERATED FROM PYTHON SOURCE LINES 64-66

Step 1: Show Model Parameters
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 66-71

.. code-block:: Python


    print("Model Calibration:")
    for param, value in rex.calibration.items():
        print(f"  {param}: {value}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Model Calibration:
      r: 1.02
      p: 5.0
      c_param: 10.0
      DiscFac: 0.95
      sigma: 0.1




.. GENERATED FROM PYTHON SOURCE LINES 72-74

Step 2: Inspect the Resource Extraction Model
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 74-77

.. code-block:: Python


    rex.resource_extraction_block.display_formulas()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    u = Control(x)
    revenue = lambda u, p: p * u
    cost = lambda u, c_param: 0.5 * c_param * u**2
    profit = lambda revenue, cost: revenue - cost
    x_after = lambda x, u: x - u
    x_growth = lambda x_after, r: r * x_after
    x = lambda x_growth, epsilon: x_growth + epsilon




.. GENERATED FROM PYTHON SOURCE LINES 78-80

Step 3: Visualize the Resource Extraction Model
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 80-88

.. code-block:: Python


    img, _ = rex.resource_extraction_block.display(rex.calibration)

    plt.figure(figsize=(10, 8))
    plt.imshow(img)
    plt.axis('off')
    plt.tight_layout()




.. image-sg:: /auto_examples/models/images/sphx_glr_plot_resource_extraction_001.png
   :alt: plot resource extraction
   :srcset: /auto_examples/models/images/sphx_glr_plot_resource_extraction_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <IPython.core.display.SVG object>




.. GENERATED FROM PYTHON SOURCE LINES 89-104

Step 4: Load Optimal Decision Rule
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This model has a closed-form optimal policy: the optimal extraction is **linear in the stock**:

.. math::

    u^* = \alpha \cdot x

The optimal extraction rate $\alpha$ is determined by solving a system of two equations involving
the model parameters. A method for solving this system is provided as ``optimal_extraction_rule``.

This analytical solution makes the model ideal for validating other policy
learning algorithms—we can compare learned policies against the known optimum.


.. GENERATED FROM PYTHON SOURCE LINES 104-111

.. code-block:: Python


    dr_u, _ = rex.make_optimal_extraction_decision_rule(rex.calibration)


    # Wrap rules in the format expected by simulator
    decision_rule = {"u": dr_u}








.. GENERATED FROM PYTHON SOURCE LINES 112-114

Step 5: Run Monte Carlo Simulation
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 114-138

.. code-block:: Python


    # Initial conditions (must be distributions, not scalar values)
    initial_conditions = {
        "x": Normal(mu=0.0, sigma=rex.calibration["sigma"]),
    }

    # Create and run simulator
    simulator = ska.MonteCarloSimulator(
        calibration=rex.calibration,
        block=rex.resource_extraction_block,
        dr=decision_rule,
        initial=initial_conditions,
        agent_count=1000,  # Simulate 5000 agents
        T_sim=100,  # For 100 periods
        seed=42,  # For reproducibility
    )

    # Run the simulation
    print("Running simulation...")
    simulator.initialize_sim()  # Initialize simulation variables
    simulator.simulate()

    print("✓ Simulation completed successfully")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Running simulation...
    ✓ Simulation completed successfully




.. GENERATED FROM PYTHON SOURCE LINES 139-141

Step 6: Plot Simulation Results
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 141-148

.. code-block:: Python


    plt.figure()
    plt.plot(simulator.history['x'].mean(axis=1), label = 'x')
    plt.plot(simulator.history['u'].mean(axis=1), label='u')
    plt.plot(simulator.history['epsilon'].mean(axis=1), label="epsilon")
    plt.plot(simulator.history['profit'].mean(axis=1), label="profit")
    plt.legend()



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_resource_extraction_002.png
   :alt: plot resource extraction
   :srcset: /auto_examples/models/images/sphx_glr_plot_resource_extraction_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.legend.Legend object at 0x760c4c11f380>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 2.261 seconds)


.. _sphx_glr_download_auto_examples_models_plot_resource_extraction.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_resource_extraction.ipynb <plot_resource_extraction.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_resource_extraction.py <plot_resource_extraction.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_resource_extraction.zip <plot_resource_extraction.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
